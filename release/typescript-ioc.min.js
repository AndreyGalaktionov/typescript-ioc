"use strict";function Singleton(t){Container.bind(t).scope(Scope.Singleton)}function Scoped(t){return function(e){Container.bind(e).scope(t)}}function Provided(t){return function(e){Container.bind(e).provider(t)}}function Provides(t){return function(e){Container.bind(t).to(e)}}function AutoWired(t){var e,n=Reflect.getOwnMetadata("params_inject",t)||[];if(n.length>0){var r=Reflect.getMetadata("design:paramtypes",t);e=InjectorHanlder.decorateConstructor(function(){for(var e=[],o=0;o<arguments.length;o++)e[o-0]=arguments[o];for(var c=e?e.concat():new Array,i=0,p=n;i<p.length;i++){var a=p[i];a>=c.length&&c.push(Container.get(r[a]))}t.apply(this,c),Container.applyInjections(this,t)},t)}else e=InjectorHanlder.decorateConstructor(function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.apply(this,e),Container.applyInjections(this,t)},t);var o=Container.bind(t);return o.toConstructor(e),e}function Inject(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(2==t.length)return InjectPropertyDecorator.apply(this,t);if(3==t.length&&"number"==typeof t[2])return InjectParamDecorator.apply(this,t);throw new Error("Invalid @Inject Decorator declaration.")}function InjectPropertyDecorator(t,e){var n=Reflect.getMetadata("design:type",t,e);Container.addPropertyInjector(t.constructor,e,n)}function InjectParamDecorator(t,e,n){if(!e){var r=Reflect.getOwnMetadata("params_inject",t,e)||[];r.push(n),Reflect.defineMetadata("params_inject",r,t,e)}}function checkType(t){if(!t)throw new TypeError("Invalid type requested to IoC container. Type is not defined.")}var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};require("reflect-metadata"),exports.Singleton=Singleton,exports.Scoped=Scoped,exports.Provided=Provided,exports.Provides=Provides,exports.AutoWired=AutoWired,exports.Inject=Inject;var Map=function(){function t(){}return t.prototype.put=function(t,e){this[t]=e},t.prototype.get=function(t){return this[t]},t}(),Container=function(){function t(){}return t.bind=function(e){checkType(e);var n=InjectorHanlder.getConstructorFromType(e),r=t.bindings.get(n);return r||(r=new ConfigImpl(n),t.bindings.put(n,r)),r},t.get=function(e){var n=t.bind(e);return n.iocprovider||n.to(n.source),n.getInstance()},t.applyInjections=function(t,e){if(e){var n=InjectorHanlder.getInjectorFromType(e,!1);n.forEach(function(e){e(t)})}else{var n=InjectorHanlder.getInjectorFromInstance(t);n.forEach(function(e){e(t)})}},t.addPropertyInjector=function(e,n,r){var o=InjectorHanlder.getInjectorFromType(e,!1);o.push(function(e){t.injectProperty(e,n,r)})},t.injectProperty=function(e,n,r){e[n]=t.get(r)},t.bindings=new Map,t}();exports.Container=Container;var ConfigImpl=function(){function t(t){this.source=t}return t.prototype.to=function(t){if(checkType(t),this.source===t){var e=this;this.iocprovider={get:function(){return e.decoratedConstructor?new e.decoratedConstructor:new t}}}else this.iocprovider={get:function(){return Container.get(t)}};return this},t.prototype.toTypeNamed=function(t){return this.iocprovider={get:function(){checkType(window[t]);var e=Object.create(window[t].prototype),n=e.constructor;return checkType(n),new n}},this},t.prototype.provider=function(t){return this.iocprovider=t,this},t.prototype.scope=function(t){return this.iocscope=t,this},t.prototype.toConstructor=function(t){return this.decoratedConstructor=t,this},t.prototype.getInstance=function(){return this.iocscope||this.scope(Scope.Local),this.iocscope.resolve(this.iocprovider,this.source)},t}(),Scope=function(){function t(){}return t}();exports.Scope=Scope;var LocalScope=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.resolve=function(t,e){return t.get()},e}(Scope);exports.LocalScope=LocalScope,Scope.Local=new LocalScope;var SingletonScope=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.resolve=function(t,n){var r=e.instances.get(n);return r||(r=t.get(),e.instances.put(n,r)),r},e.instances=new Map,e}(Scope);exports.SingletonScope=SingletonScope,Scope.Singleton=new SingletonScope;var InjectorHanlder=function(){function t(){}return t.decorateConstructor=function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=e[r]);return t.__parent=e,t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n),t},t.getConstructorFromType=function(t){var e=t;if(e.name)return e;for(;e=e.__parent;)if(e.name)return e;throw TypeError("Can not identify the base Type for requested target")},t.getConstructorFromInstance=function(e){return t.getConstructorFromType(e.constructor)},t.getInjectorFromType=function(e,n){var r=t.getConstructorFromType(e);t.typeInjections[r]||(t.typeInjections[r]=new Array);var o=t.typeInjections[r];if(n){var c=r.__parent;c&&(o=t.getInjectorFromType(c,!0).concat(o))}return o},t.getInjectorFromInstance=function(e){var n=t.getConstructorFromInstance(e);return t.getInjectorFromType(n,!0)},t.typeInjections=new Map,t}();